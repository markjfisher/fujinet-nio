# All generated .puml files go here
output_directory: docs/uml

# Shared settings applied to all diagrams
glob:
  - src/lib/**/*.cpp
  - include/fujinet/**/*.h

using_namespace:
  - fujinet

diagrams:
  gen_core_io:
    type: class
    filter_mode: advanced    # <— important

    include:
      anyof:
        namespaces:
          - fujinet::core
          - fujinet::io
        elements:
          - fujinet::fs::StorageManager

    exclude:
      namespaces:
        - fujinet::io::protocol

    plantuml:
      before:
        - "title Core + IO (auto-gen from clang-uml)"

  gen_core_io_sequence:
    type: sequence
    filter_mode: advanced

    from:
      - function: fujinet::io::IOService::serviceOnce()

    include:
      anyof:
        namespaces:
          - fujinet::io
          - fujinet::core
        elements:
          - fujinet::fs::StorageManager
          - fujinet::io::IODeviceManager
          - fujinet::io::VirtualDevice

    plantuml:
      before:
        - "title Core I/O request flow (IOService tick)"
        - "caption IOService::serviceOnce() – transports → handler"

  gen_core_device_sequence:
    type: sequence
    filter_mode: advanced
    generate_return_types: true
    generate_return_values: true
    generate_condition_statements: true
    generate_method_arguments: full

    from:
      - function: fujinet::io::IODeviceManager::handleRequest(const IORequest &)

    include:
      anyof:
        namespaces:
          - fujinet::io
        elements:
          - fujinet::io::IOResponse
          - fujinet::io::IORequest

    plantuml:
      before:
        - "title Device dispatch flow (IODeviceManager)"
        - "caption IODeviceManager::handleRequest() – device lookup → VirtualDevice::handle()"


  gen_fs:
    type: class
    include:
      namespaces:
        - fujinet::fs
    plantuml:
      before:
        - "title Filesystem (auto-gen from clang-uml)"

  gen_config:
    type: class
    include:
      namespaces:
        - fujinet::config
    plantuml:
      before:
        - "title Config (auto-gen from clang-uml)"

  gen_io_protocol:
    type: class
    include:
      namespaces:
        - fujinet::io::protocol
    plantuml:
      before:
        - "title IO Protocols (auto-gen from clang-uml)"

  gen_build_support:
    type: class
    include:
      namespaces:
        - fujinet::build
    plantuml:
      before:
        - "title Build Support (auto-gen from clang-uml)"

  gen_core_spider:
    type: class

    include:
      context:
        - match:
            pattern: fujinet::core::FujinetCore
            radius: 4              # tweak 2–4 as needed
            direction: any         # both “out” and “in”
            relationships:         # only relationships we care about
              - composition
              - aggregation
              - association
              - ownership
              - dependency         # adds method/arg/return-use too

    exclude:
      namespaces:
        - std

    using_namespace:
      - fujinet

    plantuml:
      before:
        - "title FujinetCore dependency spider (auto-gen from clang-uml)"
