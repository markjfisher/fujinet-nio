[platformio]
default_envs = esp32-espidf
src_dir = src

[env]
; Common options (can be extended later)
lib_ldf_mode = deep+

[env:esp32-espidf]
platform  = espressif32@6.10.0
framework = espidf
board     = esp32dev

; The ESP32 toolchain (GCC 8.4 in ESP-IDF 5.4.0) doesn't support -std=gnu++20,
; so we downgrade to C++17 just for this environment.
build_unflags = -std=gnu++20
build_flags =
    -std=gnu++17
    -DFN_PLATFORM_ESP32

; IMPORTANT: no src_filter / build_src_filter here.
; ESP-IDF + PlatformIO want CMakeLists.txt to decide sources.

[env:native]
platform = native

; For native builds we can use C++20 if your host compiler supports it.
build_flags =
    -std=c++20
    -DFN_PLATFORM_POSIX

; Native builds compile the library + POSIX main.
; "src_filter" is deprecated; use "build_src_filter" instead.
build_src_filter =
    +<lib/>
    +<app/main_posix.cpp>
