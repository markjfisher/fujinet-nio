group: Filesystem
steps:
  - name: "FS: list (root)"
    argv: ["{CLI}", "list", "{FS}", "/"]
    expect:
      - ":/|host|flash|sd|config"
    timeout_s: 8

  - name: "FS: write UTF-8 content to ASCII filename"
    argv: ["{CLI}", "write", "{FS}", "/utf8_content.txt", "integration-tests/data/fs_utf8.txt"]
    expect:
      # write prints nothing reliable today; just ensure it didn't error by expecting nothing.
      # (runner should treat empty expect as "exit code == 0". If it requires expect, remove this key.)
      - ""
    timeout_s: 15

  - name: "FS: read-all UTF-8 content back"
    argv: ["{CLI}", "read-all", "{FS}", "/utf8_content.txt"]
    expect:
      - "hÃ©llÃ¶"
      - "ã“ã‚“ã«ã¡ã¯"
      - "ğŸŒ"
    timeout_s: 15

  - name: "FS: write large file (>512 bytes) in chunks"
    argv: ["{CLI}", "write", "--chunk", "256", "{FS}", "/large_1k.bin", "integration-tests/data/fs_large_1k.bin"]
    expect:
      - ""
    timeout_s: 20

  - name: "FS: read-all large file back (sanity substring)"
    argv: ["{CLI}", "read-all", "{FS}", "/large_1k.bin"]
    expect:
      # The fixture starts with a recognizable ASCII prefix before binary-ish tail.
      - "FUJINET-NIO-LARGE-FILE"
    timeout_s: 20

  - name: "FS: UTF-8 filename (write)"
    argv: ["{CLI}", "write", "{FS}", "/utf8_ã“ã‚“ã«ã¡ã¯ğŸŒ.txt", "integration-tests/data/fs_utf8.txt"]
    timeout_s: 20

  - name: "FS: UTF-8 filename (read-all)"
    argv: ["{CLI}", "read-all", "{FS}", "/utf8_ã“ã‚“ã«ã¡ã¯ğŸŒ.txt"]
    expect:
      - "ã“ã‚“ã«ã¡ã¯"
      - "ğŸŒ"
    timeout_s: 20
